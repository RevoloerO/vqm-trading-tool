import{r as e,j as s}from"./vendor-react-CTd1lJGF.js";import{a}from"./useDebounce-DjtQynKA.js";import{l as i,b as t,h as n,s as l,d as o,e as r,f as c,a as d,c as m,g as h,i as p}from"./calculator-utils-D6XIt9t1.js";import{B as u,F as g}from"./FormInput-Bt1utgF7.js";import"./vendor-6ULW7vKx.js";const b={day:{id:"day",label:"Day Trader",higher:{name:"Daily",code:"daily"},mid:{name:"1-Hour",code:"1hour"},lower:{name:"15-Minute",code:"15min"},holdTime:"Minutes to Hours",tradesPerWeek:"5-20",riskPerTrade:1,riskConsolidation:.5,icon:"📊",description:"Fast-paced intraday trading. Multiple trades per day. Hold time: minutes to hours."},swing:{id:"swing",label:"Swing Trader",higher:{name:"Weekly",code:"weekly"},mid:{name:"Daily",code:"daily"},lower:{name:"4-Hour",code:"4hour"},holdTime:"2-10 Days",tradesPerWeek:"1-3",riskPerTrade:2,riskConsolidation:1,icon:"📈",description:"Multi-day position holds. 1-3 trades per week. Hold time: 2-10 days."},position:{id:"position",label:"Position Trader",higher:{name:"Monthly",code:"monthly"},mid:{name:"Weekly",code:"weekly"},lower:{name:"Daily",code:"daily"},holdTime:"Weeks to Months",tradesPerWeek:"0.25-1",riskPerTrade:2,riskConsolidation:1,icon:"🎯",description:"Long-term trend following. Few trades per month. Hold time: weeks to months."}},k={consolidationPeriod:{"15min":{bars:30,label:"30-60 minutes",description:"Has price been chopping sideways for 30+ minutes?"},"1hour":{bars:8,label:"8-12 hours",description:"Has price been ranging sideways for 8+ hours?"},"4hour":{bars:6,label:"1-2 days",description:"Has price been consolidating for 6+ bars (1-2 days)?"},daily:{bars:4,label:"4-6 days",description:"Has price been sideways for 4+ days?"},weekly:{bars:8,label:"8-12 weeks",description:"Has price been sideways for 8+ weeks?"},monthly:{bars:3,label:"3-4 months",description:"Has price been sideways for 3+ months?"}},gapTolerance:{"15min":{percent:.5,description:"Gap should be less than 0.5% for 15-minute breakouts"},"1hour":{percent:1,description:"Gap should be less than 1% for 1-hour breakouts"},"4hour":{percent:1.5,description:"Gap should be less than 1.5% for 4-hour breakouts"},daily:{percent:2,description:"Gap should be less than 2% for daily breakouts"},weekly:{percent:3,description:"Gap should be less than 3% for weekly breakouts"},monthly:{percent:4,description:"Gap should be less than 4% for monthly breakouts"}},volumeMultiplier:{"15min":{multiplier:2,description:"15-minute breakouts need 2x+ average volume"},"1hour":{multiplier:2,description:"1-hour breakouts need 2x+ average volume"},"4hour":{multiplier:1.5,description:"4-hour breakouts need 1.5x+ average volume"},daily:{multiplier:1.5,description:"Daily breakouts need 1.5x+ average volume"},weekly:{multiplier:1.25,description:"Weekly breakouts need 1.25x+ average volume"},monthly:{multiplier:1.25,description:"Monthly breakouts need 1.25x+ average volume"}},rrMinimum:{"15min":2,"1hour":2,"4hour":2,daily:2,weekly:2,monthly:2}},y={above50EMA:{day:"The 50 EMA on the Daily chart shows short-term trend bias. Price above = bullish context.",swing:"The 50 EMA on the Weekly chart confirms intermediate trend direction. Price above = bullish.",position:"The 50 EMA on the Monthly chart defines major trend direction. Price above = long-term bull market."},emaAlignment:{day:"20 EMA above 50 EMA on Daily = short-term momentum aligns with context. Signals healthy uptrend.",swing:"20 EMA above 50 EMA on Weekly = intermediate momentum building. Strong trend confirmation.",position:"20 EMA above 50 EMA on Monthly = major trend acceleration. Very bullish long-term setup."},consolidation:{day:"Daily consolidation reduces position size. Use 0.5% risk instead of 1% until breakout confirmed.",swing:"Weekly consolidation detected. Reduce to 1% risk (half size) until clear directional move.",position:"Monthly consolidation requires patience. Use 1% risk and wait for monthly trend resumption."},volumeConfirmation:{day:"Intraday breakouts need strong volume (2x average) to confirm institutional participation.",swing:"Daily breakout volume should be 1.5x average to validate setup. Check for climactic buying.",position:"Weekly volume surge (1.25x+) signals major money entering. Less critical than lower timeframes."},gapValidation:{day:"Small gaps (<0.5% on 15-min, <1% on 1-hour) are acceptable. Larger gaps increase risk.",swing:"Gaps under 2% on daily charts are workable. Larger gaps may lead to profit-taking pullbacks.",position:"Weekly gaps under 3% are acceptable for position trades. Monthly trend can absorb larger gaps."}};function x(e){return b[e]||b.swing}function f(e,s){return k[e]?.[s]||null}function v(e,s){return y[e]?.[s]||""}function j(e,s){const a=x(e);return s?a.riskConsolidation:a.riskPerTrade}const N="TOGGLE_HIGHER_CHECK",C="UPDATE_HIGHER_VALIDATION",T="TOGGLE_MID_CHECK",w="UPDATE_MID_CHECK",S="SET_PATTERN_TYPE",P="SET_GAP_PERCENTAGE",F="UPDATE_MID_PRICE",E="UPDATE_MID_VALIDATION",A="TOGGLE_LOWER_CHECK",R="UPDATE_LOWER_CHECK",D="UPDATE_POSITION_DATA",M="UPDATE_LOWER_VALIDATION",L="PROCEED_TO_MID",$="PROCEED_TO_LOWER",O="PROCEED_TO_FINAL",I="BACK_TO_HIGHER",V="BACK_TO_MID",H="SET_FINAL_DECISION",z="RESET_CHECKLIST",_="RESET_TO_STYLE_SELECTION",G="RESTORE_STATE";function B(e,s){switch(s.type){case N:return{...e,higherTF:{...e.higherTF,[s.payload.checkId]:!e.higherTF[s.payload.checkId]}};case C:return{...e,higherTF:{...e.higherTF,isComplete:s.payload.isPassed,isPassed:s.payload.isPassed},consolidationDetected:s.payload.consolidationDetected,positionSizeRecommendation:s.payload.positionAdjustment};case T:return{...e,midTF:{...e.midTF,[s.payload.checkId]:!e.midTF[s.payload.checkId]}};case w:return{...e,midTF:{...e.midTF,[s.payload.checkId]:s.payload.value}};case S:return{...e,midTF:{...e.midTF,patternType:s.payload.patternType}};case P:return{...e,midTF:{...e.midTF,gapPercentage:s.payload.value}};case F:return{...e,midTF:{...e.midTF,prices:{...e.midTF.prices,[s.payload.field]:s.payload.value}}};case E:return{...e,midTF:{...e.midTF,isComplete:s.payload.isPassed,isPassed:s.payload.isPassed}};case A:return{...e,lowerTF:{...e.lowerTF,[s.payload.checkId]:!e.lowerTF[s.payload.checkId]}};case R:return{...e,lowerTF:{...e.lowerTF,[s.payload.checkId]:s.payload.value}};case D:return{...e,lowerTF:{...e.lowerTF,positionData:{...e.lowerTF.positionData,[s.payload.field]:s.payload.value}}};case M:return{...e,lowerTF:{...e.lowerTF,isComplete:s.payload.isPassed,isPassed:s.payload.isPassed}};case L:return{...e,currentStep:"mid"};case $:return{...e,currentStep:"lower"};case O:return{...e,currentStep:"final"};case I:return{...e,currentStep:"higher"};case V:return{...e,currentStep:"mid"};case H:return{...e,finalDecision:s.payload.decision};case z:return{currentStep:"higher",higherTF:{uptrendConfirmed:!1,above50EMA:!1,emaAlignment:!1,notConsolidating:!1,clearFromResistance:!1,isComplete:!1,isPassed:!1},midTF:{breakoutOrPullback:!1,aboveEMA:!1,volumeConfirmation:!1,gapAcceptable:!1,cleanHigherLow:!1,rrAtLeast2to1:!1,patternType:"breakout",gapPercentage:"",prices:{entry:"",stop:"",target:""},isComplete:!1,isPassed:!1},lowerTF:{stopBelowStructure:!1,stopDistanceOk:!1,notAfterExtended:!1,retestOrPullback:!1,rrStillValid:!1,positionSizeValid:!1,positionData:{accountSize:"",riskPercent:"",entry:"",stop:""},isComplete:!1,isPassed:!1},consolidationDetected:!1,positionSizeRecommendation:100,finalDecision:null};case _:return{currentStep:"higher",higherTF:{uptrendConfirmed:!1,above50EMA:!1,emaAlignment:!1,notConsolidating:!1,clearFromResistance:!1,isComplete:!1,isPassed:!1},midTF:{breakoutOrPullback:!1,aboveEMA:!1,volumeConfirmation:!1,gapAcceptable:!1,cleanHigherLow:!1,rrAtLeast2to1:!1,patternType:"breakout",gapPercentage:"",prices:{entry:"",stop:"",target:""},isComplete:!1,isPassed:!1},lowerTF:{stopBelowStructure:!1,stopDistanceOk:!1,notAfterExtended:!1,retestOrPullback:!1,rrStillValid:!1,positionSizeValid:!1,positionData:{accountSize:"",riskPercent:"",entry:"",stop:""},isComplete:!1,isPassed:!1},consolidationDetected:!1,positionSizeRecommendation:100,finalDecision:null,currentStep:"styleSelection"};case G:return s.payload.state;default:return e}}const W=()=>({type:z}),U=()=>({type:_}),K=e=>({type:G,payload:{state:e}}),Y=e=>({currentStep:e.currentStep,higherTF:e.higherTF,midTF:e.midTF,lowerTF:e.lowerTF,consolidationDetected:e.consolidationDetected,positionSizeRecommendation:e.positionSizeRecommendation,finalDecision:e.finalDecision});function q(e,s=2){const a=parseFloat(e);return!isNaN(a)&&a>=s}function Z(e,s=2){const a=parseFloat(e);return!isNaN(a)&&a>0&&a<=s}function J({styleConfig:e,timeframeLabels:a,showChangeStyleConfirm:i,onChangeStyle:t,onCancelChange:n}){return e&&a?s.jsx("div",{className:"calculator-header",children:s.jsxs("div",{className:"header-content",children:[s.jsxs("div",{className:"header-left",children:[s.jsx("h2",{className:"calculator-title",children:"Multi-Timeframe Entry Checklist"}),s.jsxs("p",{className:"calculator-subtitle",children:["Step-by-step validation across ",a.higher," → ",a.mid," → ",a.lower]})]}),s.jsxs("div",{className:"header-right",children:[s.jsxs("div",{className:"style-badge-header",children:[s.jsx("span",{className:"style-badge-icon",children:e.icon}),s.jsxs("div",{className:"style-badge-text",children:[s.jsx("strong",{children:e.label}),s.jsx("span",{className:"style-badge-subtitle",children:e.holdTime})]})]}),s.jsx(u,{type:"button",onClick:t,variant:"secondary",className:"btn-change-style",children:i?"Confirm Change?":"Change Style"}),i&&s.jsx(u,{type:"button",onClick:n,variant:"secondary",className:"btn-cancel-change",children:"Cancel"})]})]})}):s.jsxs("div",{className:"calculator-header",children:[s.jsx("h2",{className:"calculator-title",children:"Multi-Timeframe Entry Checklist"}),s.jsx("p",{className:"calculator-subtitle",children:"Step-by-step validation across multiple timeframes for disciplined trade entry"})]})}function Q({onStyleSelect:a,currentStyle:i=null}){const[t,n]=e.useState(i),l=[b.day,b.swing,b.position],o=e=>{n(e)};return s.jsxs("div",{className:"trading-style-selector",children:[s.jsxs("div",{className:"style-selector-header",children:[s.jsx("h3",{className:"style-selector-title",children:"Select Your Trading Style"}),s.jsx("p",{className:"style-selector-subtitle",children:"Choose your preferred timeframe combination. This determines which charts you'll analyze."})]}),s.jsx("div",{className:"style-cards-container",children:l.map(e=>s.jsxs("div",{className:"style-card "+(t===e.id?"selected":""),onClick:()=>o(e.id),role:"button",tabIndex:0,onKeyPress:s=>{"Enter"!==s.key&&" "!==s.key||o(e.id)},children:[t===e.id&&s.jsx("div",{className:"selected-indicator",children:s.jsx("svg",{className:"selected-checkmark",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("polyline",{points:"20 6 9 17 4 12"})})}),s.jsx("div",{className:"style-card-icon",children:e.icon}),s.jsx("h4",{className:"style-card-title",children:e.label}),s.jsxs("div",{className:"style-timeframes",children:[s.jsxs("div",{className:"timeframe-row",children:[s.jsx("span",{className:"timeframe-label",children:"Context:"}),s.jsx("span",{className:"timeframe-value",children:e.higher.name})]}),s.jsxs("div",{className:"timeframe-row",children:[s.jsx("span",{className:"timeframe-label",children:"Setup:"}),s.jsx("span",{className:"timeframe-value",children:e.mid.name})]}),s.jsxs("div",{className:"timeframe-row",children:[s.jsx("span",{className:"timeframe-label",children:"Entry:"}),s.jsx("span",{className:"timeframe-value",children:e.lower.name})]})]}),s.jsx("div",{className:"style-card-divider"}),s.jsxs("div",{className:"style-details",children:[s.jsxs("div",{className:"style-detail-row",children:[s.jsx("span",{className:"detail-icon",children:"⏱️"}),s.jsxs("span",{className:"detail-text",children:["Hold: ",e.holdTime]})]}),s.jsxs("div",{className:"style-detail-row",children:[s.jsx("span",{className:"detail-icon",children:"📊"}),s.jsxs("span",{className:"detail-text",children:["Trades: ",e.tradesPerWeek,"/week"]})]}),s.jsxs("div",{className:"style-detail-row",children:[s.jsx("span",{className:"detail-icon",children:"🎲"}),s.jsxs("span",{className:"detail-text",children:["Risk: ",e.riskPerTrade,"% per trade"]})]})]}),s.jsx("p",{className:"style-card-description",children:e.description}),"swing"===e.id&&s.jsx("div",{className:"recommended-badge",children:"Recommended"})]},e.id))}),s.jsxs("div",{className:"style-selector-footer",children:[s.jsx(u,{type:"button",onClick:()=>{t&&a(t)},variant:"primary",disabled:!t,className:"btn-start-checklist",children:i?"Change Style & Reset":"Start Checklist"}),!t&&s.jsx("p",{className:"selection-hint",children:"Select a trading style to continue"}),t&&s.jsxs("p",{className:"selection-confirmation",children:["✓ ",b[t].label," selected"]})]}),s.jsxs("div",{className:"style-selector-note",children:[s.jsx("div",{className:"note-icon",children:"💡"}),s.jsxs("div",{className:"note-content",children:[s.jsx("strong",{children:"Not sure which to choose?"}),s.jsxs("p",{children:["Start with ",s.jsx("strong",{children:"Swing Trader"})," if you're new. It balances trade frequency with manageable hold times. Day trading requires constant monitoring, while position trading demands patience through volatility."]})]})]})]})}const X=e.memo(function({id:e,label:a,checked:i,onChange:t,disabled:n=!1,tooltip:l=null,autoChecked:o=!1}){return s.jsx("div",{className:`checklist-checkbox-wrapper ${i?"checked":""} ${n?"disabled":""}`,children:s.jsxs("label",{htmlFor:e,className:"checklist-checkbox-label",children:[s.jsx("input",{type:"checkbox",id:e,checked:i,onChange:t,disabled:n,className:"checklist-checkbox-input","aria-label":a}),s.jsx("span",{className:"checklist-checkbox-custom",children:s.jsx("svg",{className:"checklist-checkbox-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("polyline",{points:"20 6 9 17 4 12"})})}),s.jsxs("span",{className:"checklist-checkbox-text",children:[a,o&&s.jsx("span",{className:"auto-checked-badge",title:"Auto-checked",children:"⚡"})]}),l&&s.jsx("button",{type:"button",className:"checklist-tooltip-trigger","aria-label":"More information",title:l,children:"?"})]})})});function ee({timeframeName:e,timeframeCode:a,tradingStyle:i,checks:t,onCheckChange:n,onContinue:l,validation:o,isLocked:r}){const c=f("consolidationPeriod",a),d=[{id:"uptrendConfirmed",label:`Price making higher highs AND higher lows on ${e}`,tooltip:`Confirm the ${e} chart shows a clear pattern of consecutively higher swing highs and higher swing lows, indicating a healthy uptrend.`},{id:"above50EMA",label:`Price above ${e} 50 EMA`,tooltip:v("above50EMA",i)||`The current price should be trading above the 50 EMA on the ${e} chart, confirming trend momentum.`},{id:"emaAlignment",label:`20 EMA above 50 EMA on ${e} (alignment)`,tooltip:v("emaAlignment",i)||`The 20 EMA should be above the 50 EMA on ${e}, showing short-term momentum aligns with long-term trend.`},{id:"notConsolidating",label:`NOT in consolidation range on ${e} (${c?.label||"extended period"})`,tooltip:`${c?.description||`Price should not be ranging sideways on ${e}.`} ${v("consolidation",i)||"If consolidating, reduce position size."}`},{id:"clearFromResistance",label:`Far enough from ${e} resistance`,tooltip:`Ensure price has sufficient room to move on ${e} before hitting major resistance levels. Minimum 1:2 R:R to next resistance.`}];return s.jsxs("div",{className:"checklist-section "+(r?"locked":""),children:[s.jsxs("div",{className:"checklist-section-header",children:[s.jsxs("h3",{className:"checklist-section-title",children:[s.jsx("span",{className:"section-icon",children:"📊"}),e," Chart (Context)"]}),s.jsx("p",{className:"checklist-section-subtitle",children:"Confirm the big picture - all 5 checks required to proceed"}),o&&s.jsxs("div",{className:"checklist-counter",children:[o.passedCount," of ",o.totalChecks," checks completed"]})]}),s.jsxs("div",{className:"checklist-section-body",children:[d.map(e=>s.jsx(X,{id:`higher-${e.id}`,label:e.label,checked:t[e.id],onChange:()=>n(e.id),disabled:r,tooltip:e.tooltip},e.id)),!t.notConsolidating&&o?.consolidationDetected&&s.jsxs("div",{className:"checklist-warning",children:[s.jsx("span",{className:"warning-icon",children:"⚠️"}),s.jsxs("div",{className:"warning-content",children:[s.jsxs("strong",{children:[e," Consolidation Detected"]}),s.jsx("p",{children:o.message})]})]}),o&&s.jsx("div",{className:"validation-message "+(o.isPassed?"success":"pending"),children:o.message})]}),s.jsx("div",{className:"checklist-section-footer",children:s.jsxs(u,{type:"button",onClick:l,variant:"primary",disabled:!o?.isPassed||r,children:["Continue to ","Daily"===e?"1-Hour":"Weekly"===e?"Daily":"Weekly"," Checks"]})})]})}function se({timeframeName:a,timeframeCode:i,higherTimeframeName:t,lowerTimeframeName:n,tradingStyle:l,checks:o,onCheckChange:r,patternType:c,onPatternTypeChange:m,gapPercentage:h,onGapPercentageChange:p,prices:b,onPriceChange:k,onContinue:y,onBack:x,validation:j,isLocked:N}){const[C,T]=e.useState(null),[w,S]=e.useState(null),P=f("gapTolerance",i),F=f("volumeMultiplier",i);e.useEffect(()=>{if(b.entry&&b.stop&&b.target){const e=d({entryPrice:b.entry,stopLoss:b.stop,targetPrice:b.target});e.success?(T(e.data),q(e.data.rrRatio,2)&&!o.rrAtLeast2to1&&r("rrAtLeast2to1",!0)):T(null)}else T(null)},[b.entry,b.stop,b.target,o.rrAtLeast2to1,r]),e.useEffect(()=>{if(h&&P){const e=parseFloat(h);if(!isNaN(e)){const s=e<=P.percent;S({isValid:!0,isAcceptable:s,warning:s?null:`⚠️ Gap exceeds ${P.percent}% - Higher risk entry`})}}else S(null)},[h,P]);const E=[{id:"breakoutOrPullback",label:`Clear consolidation breakout OR pullback to support on ${a}`,tooltip:`Identify either a clean breakout from a consolidation range on ${a} with volume, or a pullback to a support level (EMA, prior breakout level).`},{id:"aboveEMA",label:`Price above ${a} 20 EMA`,tooltip:`Current price should be trading above the 20 EMA on ${a}, confirming short-term bullish momentum on this timeframe.`},{id:"volumeConfirmation",label:`Volume ${F?.multiplier||"1.5"}x+ average on ${a} breakout bar`,tooltip:v("volumeConfirmation",l)||`${F?.description||`The breakout candle on ${a} should have strong volume`}, indicating institutional participation.`},{id:"gapAcceptable",label:`Gap < ${P?.percent||"2"}% from ${a} consolidation`,tooltip:v("gapValidation",l)||`${P?.description||`If entering after a gap on ${a}, ensure gap is acceptable`} to avoid excessive risk.`},{id:"cleanerHigherLow",label:`Clean higher low if pullback setup on ${a}`,tooltip:`For pullback entries on ${a}, confirm a clean higher low has formed with price holding above the key support level.`},{id:"rrAtLeast2to1",label:"R:R potential at least 2:1",tooltip:"Risk-to-reward ratio should be at least 2:1, meaning potential profit is twice the risk amount. This is critical for profitable trading."}];return s.jsxs("div",{className:"checklist-section "+(N?"locked":""),children:[s.jsxs("div",{className:"checklist-section-header",children:[s.jsxs("h3",{className:"checklist-section-title",children:[s.jsx("span",{className:"section-icon",children:"📈"}),a," Chart (Setup)"]}),s.jsx("p",{className:"checklist-section-subtitle",children:"Identify the setup - pattern, structure, and risk/reward"}),j&&s.jsxs("div",{className:"checklist-counter",children:[j.passedCount," of ",j.totalChecks," checks completed"]})]}),s.jsxs("div",{className:"checklist-section-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{className:"form-label",children:["Pattern Type on ",a]}),s.jsxs("div",{className:"radio-group",children:[s.jsxs("label",{className:"radio-label",children:[s.jsx("input",{type:"radio",name:"patternType",value:"breakout",checked:"breakout"===c,onChange:e=>m(e.target.value),disabled:N}),s.jsx("span",{children:"Breakout"})]}),s.jsxs("label",{className:"radio-label",children:[s.jsx("input",{type:"radio",name:"patternType",value:"pullback",checked:"pullback"===c,onChange:e=>m(e.target.value),disabled:N}),s.jsx("span",{children:"Pullback"})]})]})]}),s.jsx(g,{label:`Gap from ${a} Consolidation`,value:h,onChange:e=>p(e.target.value),placeholder:P?P.percent.toString():"1.5",step:"0.1",suffix:"%",disabled:N,error:w&&!w.isValid?w.error:null}),w?.warning&&s.jsxs("div",{className:"checklist-warning small",children:[s.jsx("span",{className:"warning-icon",children:"⚠️"}),s.jsx("span",{children:w.warning})]}),s.jsxs("div",{className:"price-inputs-grid",children:[s.jsx(g,{label:"Entry Price",value:b.entry,onChange:e=>k("entry",e.target.value),placeholder:"50.00",step:"0.01",prefix:"$",disabled:N}),s.jsx(g,{label:"Stop Loss",value:b.stop,onChange:e=>k("stop",e.target.value),placeholder:"48.00",step:"0.01",prefix:"$",disabled:N}),s.jsx(g,{label:"Target Price",value:b.target,onChange:e=>k("target",e.target.value),placeholder:"56.00",step:"0.01",prefix:"$",disabled:N})]}),C&&s.jsxs("div",{className:"rr-result-inline "+(C.isValidTrade?"success":"warning"),children:[s.jsxs("div",{className:"rr-result-item",children:[s.jsx("span",{className:"rr-label",children:"R:R Ratio:"}),s.jsxs("span",{className:"rr-value",children:["1:",C.rrRatio]})]}),s.jsxs("div",{className:"rr-result-item",children:[s.jsx("span",{className:"rr-label",children:"Risk/Share:"}),s.jsxs("span",{className:"rr-value",children:["$",C.riskPerShare]})]}),s.jsxs("div",{className:"rr-result-item",children:[s.jsx("span",{className:"rr-label",children:"Reward/Share:"}),s.jsxs("span",{className:"rr-value",children:["$",C.rewardPerShare]})]})]}),s.jsx("div",{className:"checklist-items",children:E.map(e=>s.jsx(X,{id:`mid-${e.id}`,label:e.label,checked:o[e.id],onChange:()=>r(e.id),disabled:N,tooltip:e.tooltip,autoChecked:"rrAtLeast2to1"===e.id&&C&&q(C.rrRatio)},e.id))}),j&&s.jsx("div",{className:"validation-message "+(j.isPassed?"success":"pending"),children:j.message})]}),s.jsxs("div",{className:"checklist-section-footer",children:[s.jsxs(u,{type:"button",onClick:x,variant:"secondary",disabled:N,children:["Back to ",t]}),s.jsxs(u,{type:"button",onClick:y,variant:"primary",disabled:!j?.isPassed||N,children:["Continue to ",n," Checks"]})]})]})}function ae({timeframeName:a,timeframeCode:i,midTimeframeName:t,tradingStyle:n,checks:l,onCheckChange:o,positionData:r,onPositionDataChange:c,recommendedRiskPercent:d,onContinue:h,onBack:p,validation:b,isLocked:k}){const[y,x]=e.useState(null),[f,v]=e.useState(null);e.useEffect(()=>{if(r.accountSize&&r.riskPercent&&r.entry&&r.stop){const e=m({accountSize:r.accountSize,riskPercent:r.riskPercent,entryPrice:r.entry,stopLoss:r.stop});e.success?(x(e.data),v(null),Z(parseFloat(r.riskPercent),"day"===n?1:2)&&!l.positionSizeValid&&o("positionSizeValid",!0)):(x(null),v(e.error))}},[r.accountSize,r.riskPercent,r.entry,r.stop,n]);const j=[{id:"stopBelowStructure",label:`Can place stop below ${a} structure (swing low)`,tooltip:`Ensure you can place your stop loss below a clear ${a} swing low, providing proper structure protection without excessive distance.`},{id:"stopDistanceOk",label:`Stop distance on ${a} allows proper position size`,tooltip:`The distance to your stop on ${a} should allow for a reasonable position size. If stop is too far, position size becomes too small to be worthwhile.`},{id:"notAfterExtended",label:`NOT entering after 3+ consecutive up-bars on ${a}`,tooltip:`Avoid entering after 3 or more consecutive bullish bars on ${a}, as price may be overextended and due for a pullback or consolidation.`},{id:"retestOrPullback",label:`Retest of breakout level OR first pullback on ${a}`,tooltip:`Entry should be on a retest of the breakout level or the first pullback after breakout on ${a}, not chasing extended moves.`},{id:"rrStillValid",label:`R:R still 2:1+ after ${a} gap adjustment`,tooltip:`After accounting for any gap and final stop placement on ${a}, ensure risk-to-reward ratio is still at least 2:1.`},{id:"positionSizeValid",label:`Position size calculated and within ${d}% risk`,tooltip:`Calculated position size should keep total risk at or below ${d}% of account. This is critical for long-term capital preservation.`}],N="day"===n?1:2;return s.jsxs("div",{className:"checklist-section "+(k?"locked":""),children:[s.jsxs("div",{className:"checklist-section-header",children:[s.jsxs("h3",{className:"checklist-section-title",children:[s.jsx("span",{className:"section-icon",children:"⏰"}),a," Chart (Entry Trigger)"]}),s.jsx("p",{className:"checklist-section-subtitle",children:"Fine-tune the entry - timing, structure, and position size"}),b&&s.jsxs("div",{className:"checklist-counter",children:[b.passedCount," of ",b.totalChecks," checks completed"]})]}),s.jsxs("div",{className:"checklist-section-body",children:[s.jsxs("div",{className:"position-calculator-inline",children:[s.jsx("h4",{className:"inline-calc-title",children:"Position Size Calculator"}),d<100*N&&s.jsxs("div",{className:"risk-recommendation",children:[s.jsx("span",{className:"warning-icon",children:"⚠️"}),s.jsxs("span",{children:["Recommended risk: ",d,"% (due to higher timeframe consolidation)"]})]}),s.jsxs("div",{className:"position-inputs-grid",children:[s.jsx(g,{label:"Account Size",value:r.accountSize,onChange:e=>c("accountSize",e.target.value),placeholder:"10000",prefix:"$",disabled:k}),s.jsx(g,{label:"Risk Percent",value:r.riskPercent,onChange:e=>c("riskPercent",e.target.value),placeholder:d.toString(),step:"0.1",suffix:"%",disabled:k}),s.jsx(g,{label:"Entry Price",value:r.entry,onChange:e=>c("entry",e.target.value),placeholder:"50.00",step:"0.01",prefix:"$",disabled:k}),s.jsx(g,{label:"Stop Loss",value:r.stop,onChange:e=>c("stop",e.target.value),placeholder:"48.00",step:"0.01",prefix:"$",disabled:k})]}),y&&s.jsxs("div",{className:"position-result-inline success",children:[s.jsxs("div",{className:"position-result-item highlight",children:[s.jsx("span",{className:"position-label",children:"Shares to Buy:"}),s.jsx("span",{className:"position-value",children:y.shares})]}),s.jsxs("div",{className:"position-result-item",children:[s.jsx("span",{className:"position-label",children:"Position Value:"}),s.jsxs("span",{className:"position-value",children:["$",y.positionValue]})]}),s.jsxs("div",{className:"position-result-item",children:[s.jsx("span",{className:"position-label",children:"Dollar Risk:"}),s.jsxs("span",{className:"position-value risk",children:["$",y.riskAmount]})]}),s.jsxs("div",{className:"position-result-item",children:[s.jsx("span",{className:"position-label",children:"% of Account:"}),s.jsxs("span",{className:"position-value",children:[y.percentOfAccount,"%"]})]})]}),f&&s.jsx("div",{className:"field-error",children:f})]}),s.jsx("div",{className:"checklist-items",children:j.map(e=>s.jsx(X,{id:`lower-${e.id}`,label:e.label,checked:l[e.id],onChange:()=>o(e.id),disabled:k,tooltip:e.tooltip,autoChecked:"positionSizeValid"===e.id&&y&&Z(parseFloat(r.riskPercent),N)},e.id))}),b&&s.jsx("div",{className:"validation-message "+(b.isPassed?"success":"pending"),children:b.message})]}),s.jsxs("div",{className:"checklist-section-footer",children:[s.jsxs(u,{type:"button",onClick:p,variant:"secondary",disabled:k,children:["Back to ",t]}),s.jsx(u,{type:"button",onClick:h,variant:"primary",disabled:!b?.isPassed||k,children:"View Final Decision"})]})]})}function ie({higherValidation:a,midValidation:i,lowerValidation:t,recommendation:n,positionResult:l,tradingStyle:o="swing",timeframeLabels:r,onExecuteTrade:c,onPassTrade:d,onSaveForLater:m,onReset:p,fullState:g}){const[k,y]=e.useState(!1),[x,f]=e.useState(!1),v=b[o]||b.swing,j=r||{higher:"Weekly",mid:"Daily",lower:"4-Hour"},N=(e,a)=>{if(!e)return null;let i="status-badge ",t="";return e.isPassed?(i+="success",t=a===j.higher?"UPTREND":a===j.mid?"SETUP CONFIRMED":"ENTRY TRIGGER"):(i+="warning",t=a===j.higher?"NOT ALIGNED":a===j.mid?"WAITING":"NO ENTRY"),s.jsx("span",{className:i,children:t})},C=a?.isPassed&&i?.isPassed&&t?.isPassed;return s.jsxs("div",{className:"final-decision-panel",children:[s.jsxs("div",{className:"checklist-section-header",children:[s.jsxs("h3",{className:"checklist-section-title",children:[s.jsx("span",{className:"section-icon",children:"🎯"}),"Final Decision"]}),s.jsx("p",{className:"checklist-section-subtitle",children:"Review all timeframes and make your trading decision"})]}),s.jsxs("div",{className:"final-decision-body",children:[s.jsxs("div",{className:"trading-style-badge",children:[s.jsx("span",{className:"badge-icon",children:v.icon}),s.jsxs("div",{className:"badge-content",children:[s.jsxs("strong",{children:["Trading Style: ",v.label.toUpperCase()]}),s.jsxs("span",{className:"badge-subtitle",children:["Hold Time: ",v.holdTime," | Trades: ",v.tradesPerWeek,"/week"]})]})]}),s.jsxs("div",{className:"status-summary",children:[s.jsx("h4",{className:"status-summary-title",children:"Timeframe Analysis"}),s.jsxs("div",{className:"status-items",children:[s.jsxs("div",{className:"status-item",children:[s.jsxs("span",{className:"status-label",children:[j.higher," Status:"]}),N(a,j.higher)]}),s.jsxs("div",{className:"status-item",children:[s.jsxs("span",{className:"status-label",children:[j.mid," Status:"]}),N(i,j.mid)]}),s.jsxs("div",{className:"status-item",children:[s.jsxs("span",{className:"status-label",children:[j.lower," Status:"]}),N(t,j.lower)]})]})]}),s.jsxs("div",{className:"recommendation-section",children:[s.jsx("h4",{className:"recommendation-title",children:"Position Size Recommendation"}),(()=>{if(!n)return null;const e=`recommendation-badge ${n.color}`,i=a?.recommendedRisk||v?.riskPerTrade||2;return s.jsxs("div",{className:e,children:[s.jsxs("div",{className:"recommendation-main",children:[s.jsxs("span",{className:"recommendation-size",children:[n.recommendation,"%"]}),s.jsx("span",{className:"recommendation-status",children:n.status})]}),s.jsx("div",{className:"recommendation-reason",children:n.reason}),s.jsxs("div",{className:"recommendation-details",children:[s.jsx("span",{className:"detail-icon",children:"🎲"}),s.jsxs("span",{children:["Recommended Risk: ",i,"% (",v.label," standard)"]})]})]})})()]}),l&&C&&s.jsxs("div",{className:"position-details",children:[s.jsx("h4",{className:"position-details-title",children:"Position Details"}),s.jsxs("div",{className:"position-details-grid",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Shares:"}),s.jsx("span",{className:"detail-value highlight",children:l.shares})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Position Value:"}),s.jsxs("span",{className:"detail-value",children:["$",l.positionValue]})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Dollar Risk:"}),s.jsxs("span",{className:"detail-value risk",children:["$",l.riskAmount]})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Risk Per Share:"}),s.jsxs("span",{className:"detail-value",children:["$",l.riskPerShare]})]})]})]}),!C&&s.jsxs("div",{className:"decision-warning",children:[s.jsx("span",{className:"warning-icon",children:"⚠️"}),s.jsxs("div",{className:"warning-content",children:[s.jsx("strong",{children:"Trade Not Ready"}),s.jsx("p",{children:"Not all timeframe checks have passed. Review the incomplete sections above."})]})]}),C&&s.jsxs("div",{className:"confidence-indicator",children:[s.jsxs("div",{className:"confidence-header",children:[s.jsx("span",{className:"confidence-label",children:"Trade Confidence:"}),s.jsx("span",{className:"confidence-value",children:a?.consolidationDetected?"MODERATE":"HIGH"})]}),s.jsx("div",{className:"confidence-bar",children:s.jsx("div",{className:"confidence-fill "+(a?.consolidationDetected?"moderate":"high"),style:{width:a?.consolidationDetected?"60%":"100%"}})})]}),s.jsx("div",{className:"decision-actions",children:C?s.jsxs(s.Fragment,{children:[s.jsxs(u,{type:"button",onClick:()=>{const e={action:"execute",timestamp:(new Date).toISOString(),recommendation:n,tradingStyle:o,expectedHoldTime:v.holdTime};h(g,e),c()},variant:"primary",className:"btn-execute",children:[s.jsx("span",{className:"btn-icon",children:"✓"}),"Execute Trade"]}),s.jsxs(u,{type:"button",onClick:m,variant:"secondary",className:"btn-save",children:[s.jsx("span",{className:"btn-icon",children:"💾"}),"Save for Later"]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(u,{type:"button",onClick:()=>{if(!k)return void y(!0);const e={action:"pass",timestamp:(new Date).toISOString(),reason:"Trade does not meet all criteria"};d(e),y(!1)},variant:"secondary",className:"btn-pass",children:[s.jsx("span",{className:"btn-icon",children:"✗"}),k?"Confirm: Pass Trade":"Pass Trade"]}),k&&s.jsx(u,{type:"button",onClick:()=>y(!1),variant:"secondary",children:"Cancel"})]})}),s.jsxs("div",{className:"reset-section",children:[s.jsx(u,{type:"button",onClick:()=>{x?(p(),f(!1)):f(!0)},variant:"secondary",className:"btn-reset",children:x?"Confirm: Reset Checklist":"Reset Checklist"}),x&&s.jsx(u,{type:"button",onClick:()=>f(!1),variant:"secondary",children:"Cancel"})]})]})]})}function te(e){let s=0;return e.higher?.isPassed&&s++,e.mid?.isPassed&&s++,e.lower?.isPassed&&s++,Math.round(s/3*100)}const ne=e.memo(function({currentStep:e,validation:a,timeframeLabels:i=null}){const t=i||{higher:"Weekly",mid:"Daily",lower:"4-Hour"},n=[{id:"higher",label:t.higher,number:1},{id:"mid",label:t.mid,number:2},{id:"lower",label:t.lower,number:3},{id:"final",label:"Decision",number:4}];return s.jsxs("div",{className:"progress-bar-container",children:[s.jsx("div",{className:"progress-bar-steps",children:n.map((i,t)=>{const l=(s=>{if("final"===s)return"final"===e?"active":a.higher?.isPassed&&a.mid?.isPassed&&a.lower?.isPassed?"unlocked":"locked";const i=a[s];return i?.isPassed?"completed":e===s?"active":n.findIndex(e=>e.id===s)<n.findIndex(s=>s.id===e)?"unlocked":"locked"})(i.id),o=t===n.length-1;return s.jsxs(React.Fragment,{children:[s.jsxs("div",{className:`progress-step ${l}`,children:[s.jsx("div",{className:"progress-step-circle",children:"completed"===l?s.jsx("svg",{className:"progress-step-check",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("polyline",{points:"20 6 9 17 4 12"})}):s.jsx("span",{className:"progress-step-number",children:i.number})}),s.jsx("span",{className:"progress-step-label",children:i.label})]}),!o&&s.jsx("div",{className:"progress-connector "+("completed"===l?"completed":"")})]},i.id)})}),s.jsxs("div",{className:"progress-summary",children:[s.jsx("div",{className:"progress-summary-bar",children:s.jsx("div",{className:"progress-summary-fill",style:{width:`${te(a)}%`}})}),s.jsxs("span",{className:"progress-summary-text",children:[te(a),"% Complete"]})]}),i&&s.jsxs("div",{className:"timeframe-flow-summary",children:[s.jsx("span",{className:"flow-label",children:"Context:"}),s.jsx("span",{className:"flow-value",children:t.higher}),s.jsx("span",{className:"flow-arrow",children:"→"}),s.jsx("span",{className:"flow-label",children:"Setup:"}),s.jsx("span",{className:"flow-value",children:t.mid}),s.jsx("span",{className:"flow-arrow",children:"→"}),s.jsx("span",{className:"flow-label",children:"Entry:"}),s.jsx("span",{className:"flow-value",children:t.lower})]})]})});function le(){const{tradingStyle:d,timeframeConfig:m,checklistState:h,styleConfig:u,showRestorePrompt:g,showChangeStyleConfirm:b,currentStep:k,isMidLocked:y,isLowerLocked:f,handleStyleSelect:v,handleChangeStyle:z,cancelChangeStyle:_,updateHigherTF:G,proceedToMid:q,updateMidTF:Z,updatePatternType:X,updateGapPercentage:te,updateMidPrice:le,proceedToLower:oe,backToHigher:re,updateLowerTF:ce,updatePositionData:de,proceedToFinal:me,backToMid:he,executeTrade:pe,passTrade:ue,resetChecklist:ge,restoreSavedState:be,dismissRestorePrompt:ke,updateValidationResults:ye}=function(){const[s,d]=e.useState(null),[m,h]=e.useState(null),[p,u]=e.useReducer(B,{currentStep:"higher",higherTF:{uptrendConfirmed:!1,above50EMA:!1,emaAlignment:!1,notConsolidating:!1,clearFromResistance:!1,isComplete:!1,isPassed:!1},midTF:{breakoutOrPullback:!1,aboveEMA:!1,volumeConfirmation:!1,gapAcceptable:!1,cleanHigherLow:!1,rrAtLeast2to1:!1,patternType:"breakout",gapPercentage:"",prices:{entry:"",stop:"",target:""},isComplete:!1,isPassed:!1},lowerTF:{stopBelowStructure:!1,stopDistanceOk:!1,notAfterExtended:!1,retestOrPullback:!1,rrStillValid:!1,positionSizeValid:!1,positionData:{accountSize:"",riskPercent:"",entry:"",stop:""},isComplete:!1,isPassed:!1},consolidationDetected:!1,positionSizeRecommendation:100,finalDecision:null}),[g,b]=e.useState(!1),[k,y]=e.useState(!1),f=e.useMemo(()=>s?x(s):null,[s]),v=p.currentStep,j=p.higherTF.isPassed,z=(e=>e.midTF.isPassed)(p),_=(e=>e.lowerTF.isPassed)(p),G=(e=>!e.higherTF.isPassed)(p),q=(e=>!e.midTF.isPassed)(p);e.useEffect(()=>{const e=i(),s=t();if(e&&e.tradingStyle)d(e.tradingStyle),x(e.tradingStyle),h(e.timeframeConfig),u(K(e.checklistState));else if(s){d(s.style);const e=x(s.style);h({higher:e.higher.code,mid:e.mid.code,lower:e.lower.code})}else n()&&b(!0)},[]);const Z=a((e,s,a)=>{if(e){const i={tradingStyle:e,timeframeConfig:s,checklistState:Y(a)};l(i)}},2e3);e.useEffect(()=>{s&&Z(s,m,p)},[s,m,p,Z]);const J=e.useCallback(()=>{if(s){const e={tradingStyle:s,timeframeConfig:m,checklistState:Y(p)};l(e)}},[s,m,p]),Q=e.useCallback(e=>{const s=x(e);d(e),h({higher:s.higher.code,mid:s.mid.code,lower:s.lower.code}),u(W()),o(e,s),setTimeout(()=>{const a={tradingStyle:e,timeframeConfig:{higher:s.higher.code,mid:s.mid.code,lower:s.lower.code},checklistState:{currentStep:"higher",higherTF:{uptrendConfirmed:!1,above50EMA:!1,emaAlignment:!1,notConsolidating:!1,clearFromResistance:!1,isComplete:!1,isPassed:!1},midTF:{breakoutOrPullback:!1,aboveEMA:!1,volumeConfirmation:!1,gapAcceptable:!1,cleanHigherLow:!1,rrAtLeast2to1:!1,patternType:"breakout",gapPercentage:"",prices:{entry:"",stop:"",target:""},isComplete:!1,isPassed:!1},lowerTF:{stopBelowStructure:!1,stopDistanceOk:!1,notAfterExtended:!1,retestOrPullback:!1,rrStillValid:!1,positionSizeValid:!1,positionData:{accountSize:"",riskPercent:"",entry:"",stop:""},isComplete:!1,isPassed:!1},consolidationDetected:!1,positionSizeRecommendation:100,finalDecision:null}};l(a)},0)},[]),X=e.useCallback(()=>{k?(r(),c(),d(null),h(null),u(U()),y(!1)):y(!0)},[k]),ee=e.useCallback(()=>{y(!1)},[]),se=e.useCallback(e=>{u((e=>({type:N,payload:{checkId:e}}))(e))},[]),ae=e.useCallback(()=>{u({type:L}),J()},[J]),ie=e.useCallback((e,s)=>{u(void 0!==s?((e,s)=>({type:w,payload:{checkId:e,value:s}}))(e,s):(e=>({type:T,payload:{checkId:e}}))(e))},[]),te=e.useCallback(e=>{u({type:S,payload:{patternType:e}})},[]),ne=e.useCallback(e=>{u((e=>({type:P,payload:{value:e}}))(e))},[]),le=e.useCallback((e,s)=>{u(((e,s)=>({type:F,payload:{field:e,value:s}}))(e,s))},[]),oe=e.useCallback(()=>{u({type:$}),J()},[J]),re=e.useCallback(()=>{u({type:I})},[]),ce=e.useCallback((e,s)=>{u(void 0!==s?((e,s)=>({type:R,payload:{checkId:e,value:s}}))(e,s):(e=>({type:A,payload:{checkId:e}}))(e))},[]),de=e.useCallback((e,s)=>{u(((e,s)=>({type:D,payload:{field:e,value:s}}))(e,s))},[]),me=e.useCallback(()=>{u({type:O}),J()},[J]),he=e.useCallback(()=>{u({type:V})},[]),pe=e.useCallback(()=>{r(),c(),d(null),h(null),u(U())},[]),ue=e.useCallback(e=>{u((e=>({type:H,payload:{decision:e}}))(e)),J()},[J]),ge=e.useCallback(()=>{r(),u(W()),setTimeout(()=>{l({tradingStyle:s,timeframeConfig:m,checklistState:{currentStep:"higher",higherTF:{uptrendConfirmed:!1,above50EMA:!1,emaAlignment:!1,notConsolidating:!1,clearFromResistance:!1,isComplete:!1,isPassed:!1},midTF:{breakoutOrPullback:!1,aboveEMA:!1,volumeConfirmation:!1,gapAcceptable:!1,cleanHigherLow:!1,rrAtLeast2to1:!1,patternType:"breakout",gapPercentage:"",prices:{entry:"",stop:"",target:""},isComplete:!1,isPassed:!1},lowerTF:{stopBelowStructure:!1,stopDistanceOk:!1,notAfterExtended:!1,retestOrPullback:!1,rrStillValid:!1,positionSizeValid:!1,positionData:{accountSize:"",riskPercent:"",entry:"",stop:""},isComplete:!1,isPassed:!1},consolidationDetected:!1,positionSizeRecommendation:100,finalDecision:null}})},0)},[s,m]),be=e.useCallback(()=>{const e=i();e&&(d(e.tradingStyle),h(e.timeframeConfig),u(K(e.checklistState))),b(!1)},[]),ke=e.useCallback(()=>{r(),b(!1)},[]),ye=e.useCallback(e=>{var s;e.higher&&u((s=e.higher,{type:C,payload:s})),e.mid&&u((e=>({type:E,payload:e}))(e.mid)),e.lower&&u((e=>({type:M,payload:e}))(e.lower))},[]);return{tradingStyle:s,timeframeConfig:m,checklistState:p,styleConfig:f,showRestorePrompt:g,showChangeStyleConfirm:k,currentStep:v,isHigherComplete:j,isMidComplete:z,isLowerComplete:_,isMidLocked:G,isLowerLocked:q,handleStyleSelect:Q,handleChangeStyle:X,cancelChangeStyle:ee,updateHigherTF:se,proceedToMid:ae,updateMidTF:ie,updatePatternType:te,updateGapPercentage:ne,updateMidPrice:le,proceedToLower:oe,backToHigher:re,updateLowerTF:ce,updatePositionData:de,proceedToFinal:me,backToMid:he,executeTrade:pe,passTrade:ue,resetChecklist:ge,restoreSavedState:be,dismissRestorePrompt:ke,updateValidationResults:ye,saveImmediately:J}}(),{higherValidation:xe,midValidation:fe,lowerValidation:ve,recommendation:je,recommendedRiskPercent:Ne,timeframeLabels:Ce,validationResults:Te}=function(s,a){const[i,t]=e.useState(null),[n,l]=e.useState(null),[o,r]=e.useState(null),[c,d]=e.useState(null),m=e.useMemo(()=>a?{higher:a.higher.name,mid:a.mid.name,lower:a.lower.name}:null,[a]),h=e.useMemo(()=>({uptrendConfirmed:s.higherTF.uptrendConfirmed,above50EMA:s.higherTF.above50EMA,emaAlignment:s.higherTF.emaAlignment,notConsolidating:s.higherTF.notConsolidating,clearFromResistance:s.higherTF.clearFromResistance}),[s.higherTF.uptrendConfirmed,s.higherTF.above50EMA,s.higherTF.emaAlignment,s.higherTF.notConsolidating,s.higherTF.clearFromResistance]);e.useEffect(()=>{if(!s.tradingStyle||!a)return;const e=function(e,s="Weekly",a="swing"){const{uptrendConfirmed:i,above50EMA:t,emaAlignment:n,notConsolidating:l,clearFromResistance:o}=e,r=[i,t,n,l,o].filter(Boolean).length,c=5===r,d=!l,m=j(a,!1),h=j(a,!0);let p=100,u="";return c?d?(p=50,u={daily:`Daily chart consolidating - reduce to ${h}% risk`,weekly:`Weekly consolidation detected - reduce to ${h}% risk`,monthly:`Monthly consolidation - reduce to ${h}% risk`}[s.toLowerCase()]||`${s} consolidation detected - Recommend 50% position size`):u=`✓ ${s} context validated - Full position approved (${m}% risk)`:(p=0,u=`${s} checks incomplete (${r}/5). Complete all checks to proceed.`),{isPassed:c,consolidationDetected:d,positionAdjustment:p,message:u,passedCount:r,totalChecks:5,recommendedRisk:d?h:m}}(s.higherTF,a.higher.name,s.tradingStyle);t(e)},[h,s.tradingStyle,a]);const p=e.useMemo(()=>({breakoutOrPullback:s.midTF.breakoutOrPullback,aboveEMA:s.midTF.aboveEMA,volumeConfirmation:s.midTF.volumeConfirmation,gapAcceptable:s.midTF.gapAcceptable,cleanHigherLow:s.midTF.cleanHigherLow,rrAtLeast2to1:s.midTF.rrAtLeast2to1}),[s.midTF.breakoutOrPullback,s.midTF.aboveEMA,s.midTF.volumeConfirmation,s.midTF.gapAcceptable,s.midTF.cleanHigherLow,s.midTF.rrAtLeast2to1]);e.useEffect(()=>{if(!s.tradingStyle||!a)return;const e=function(e,s="Daily",a="4-Hour"){const{breakoutOrPullback:i,aboveEMA:t,volumeConfirmation:n,gapAcceptable:l,cleanHigherLow:o,rrAtLeast2to1:r}=e,c=[i,t,n,l,o,r].filter(Boolean).length,d=6===c,m=[];i||m.push("Breakout/Pullback pattern"),t||m.push("Price above 20 EMA"),n||m.push("Volume confirmation"),l||m.push("Gap validation"),o||m.push("Higher low structure"),r||m.push("R:R minimum 2:1");let h="";return h=d?`✓ ${s} setup confirmed - Proceed to ${a} checks`:`${s} setup incomplete (${c}/6). Missing: ${m.join(", ")}`,{isPassed:d,missingChecks:m,passedCount:c,totalChecks:6,message:h}}(s.midTF,a.mid.name,a.lower.name);l(e)},[p,s.tradingStyle,a]);const u=e.useMemo(()=>({stopBelowStructure:s.lowerTF.stopBelowStructure,stopDistanceOk:s.lowerTF.stopDistanceOk,notAfterExtended:s.lowerTF.notAfterExtended,retestOrPullback:s.lowerTF.retestOrPullback,rrStillValid:s.lowerTF.rrStillValid,positionSizeValid:s.lowerTF.positionSizeValid}),[s.lowerTF.stopBelowStructure,s.lowerTF.stopDistanceOk,s.lowerTF.notAfterExtended,s.lowerTF.retestOrPullback,s.lowerTF.rrStillValid,s.lowerTF.positionSizeValid]);e.useEffect(()=>{if(!s.tradingStyle||!a)return;s.tradingStyle;const e=function(e,s="4-Hour"){const{stopBelowStructure:a,stopDistanceOk:i,notAfterExtended:t,retestOrPullback:n,rrStillValid:l,positionSizeValid:o}=e,r=[a,i,t,n,l,o].filter(Boolean).length,c=6===r,d=c,m=[];a||m.push("Stop below structure"),i||m.push("Stop distance validation"),t||m.push("Entry timing check"),n||m.push("Retest confirmation"),l||m.push("R:R validation"),o||m.push("Position size within limits");let h="";return h=c?"✓ Entry trigger confirmed - Ready to execute":`${s} entry checks incomplete (${r}/6). Missing: ${m.join(", ")}`,{isPassed:c,readyToExecute:d,missingChecks:m,passedCount:r,totalChecks:6,message:h}}(s.lowerTF,a.lower.name);r(e)},[u,s.tradingStyle,a]),e.useEffect(()=>{if(i&&n&&o&&m){const e=function(e,s,a,i="Weekly",t="Daily",n="4-Hour"){return e.isPassed?s.isPassed?a.isPassed?e.consolidationDetected?{recommendation:50,status:"HALF SIZE",reason:`${i} consolidation - reduced position`,color:"warning"}:{recommendation:100,status:"FULL SIZE",reason:"All timeframes aligned",color:"success"}:{recommendation:0,status:"NO ENTRY",reason:`${n} entry not triggered`,color:"warning"}:{recommendation:0,status:"WAIT",reason:`${t} setup not ready`,color:"warning"}:{recommendation:0,status:"NO TRADE",reason:`${i} timeframe not aligned`,color:"error"}}(i,n,o,m.higher,m.mid,m.lower);d(e)}},[i,n,o,m]);const g=e.useMemo(()=>!i?.isPassed,[i]),b=e.useMemo(()=>!n?.isPassed,[n]),k=e.useMemo(()=>i?.recommendedRisk||j(s.tradingStyle||"swing",s.consolidationDetected),[i,s.tradingStyle,s.consolidationDetected]),y=e.useMemo(()=>({higher:i,mid:n,lower:o}),[i,n,o]);return{higherValidation:i,midValidation:n,lowerValidation:o,recommendation:c,isMidLocked:g,isLowerLocked:b,recommendedRiskPercent:k,timeframeLabels:m,validationResults:y}}(h,u);e.useEffect(()=>{(Te.higher||Te.mid||Te.lower)&&ye(Te)},[Te,ye]);const we=e.useCallback(()=>{xe?.isPassed&&q()},[xe?.isPassed,q]),Se=e.useCallback(()=>{fe?.isPassed&&oe()},[fe?.isPassed,oe]),Pe=e.useCallback(()=>{ve?.isPassed&&me()},[ve?.isPassed,me]),Fe=e.useCallback(()=>{alert("Trade executed! Trade data has been downloaded as JSON."),pe()},[pe]),Ee=e.useCallback(e=>{ue(e),alert("Trade passed and recorded.")},[ue]),Ae=e.useCallback(()=>{alert("Checklist saved! You can resume within 24 hours.")},[]),Re=e.useMemo(()=>h.lowerTF.positionData.accountSize?{shares:0,positionValue:"0.00",riskAmount:"0.00",riskPerShare:"0.00"}:null,[h.lowerTF.positionData.accountSize]);return"styleSelection"!==k&&d?s.jsxs("div",{className:"calculator-card mtf-checklist",children:[s.jsx(J,{styleConfig:u,timeframeLabels:Ce,showChangeStyleConfirm:b,onChangeStyle:z,onCancelChange:_}),g&&s.jsxs("div",{className:"restore-prompt",children:[s.jsx("span",{className:"restore-icon",children:"💾"}),s.jsxs("div",{className:"restore-content",children:[s.jsx("strong",{children:"Saved checklist found"}),s.jsxs("p",{children:["Last saved: ",p()?.toLocaleString()]})]}),s.jsxs("div",{className:"restore-actions",children:[s.jsx("button",{onClick:be,className:"btn btn-primary btn-sm",children:"Restore"}),s.jsx("button",{onClick:ke,className:"btn btn-secondary btn-sm",children:"Start Fresh"})]})]}),s.jsx(ne,{currentStep:k,validation:{higher:xe,mid:fe,lower:ve},timeframeLabels:Ce}),("higher"===k||xe?.isPassed)&&s.jsx(ee,{timeframeName:Ce.higher,timeframeCode:m.higher,tradingStyle:d,checks:h.higherTF,onCheckChange:G,onContinue:we,validation:xe,isLocked:"higher"!==k}),("mid"===k||fe?.isPassed)&&!y&&s.jsx(se,{timeframeName:Ce.mid,timeframeCode:m.mid,higherTimeframeName:Ce.higher,lowerTimeframeName:Ce.lower,tradingStyle:d,checks:h.midTF,onCheckChange:Z,patternType:h.midTF.patternType,onPatternTypeChange:X,gapPercentage:h.midTF.gapPercentage,onGapPercentageChange:te,prices:h.midTF.prices,onPriceChange:le,onContinue:Se,onBack:re,validation:fe,isLocked:"mid"!==k}),"lower"===k&&!f&&s.jsx(ae,{timeframeName:Ce.lower,timeframeCode:m.lower,midTimeframeName:Ce.mid,tradingStyle:d,checks:h.lowerTF,onCheckChange:ce,positionData:h.lowerTF.positionData,onPositionDataChange:de,recommendedRiskPercent:Ne,onContinue:Pe,onBack:he,validation:ve,isLocked:!1}),"final"===k&&s.jsx(ie,{higherValidation:xe,midValidation:fe,lowerValidation:ve,recommendation:je,positionResult:Re,tradingStyle:d,timeframeLabels:Ce,onExecuteTrade:Fe,onPassTrade:Ee,onSaveForLater:Ae,onReset:ge,fullState:h})]}):s.jsxs("div",{className:"calculator-card mtf-checklist",children:[s.jsx(J,{}),s.jsx(Q,{onStyleSelect:v,currentStyle:d})]})}export{le as default};
